"use strict";(self.webpackChunk_minimajs_docs=self.webpackChunk_minimajs_docs||[]).push([[3099],{9127:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>o});var r=n(86),t=n(6491);const i={title:"Http Helpers",sidebar_position:4,tags:["request","response","error","context"]},a=void 0,l={id:"Guide/http",title:"Http Helpers",description:"The request/response are globally accessible anywhere from request contexts.",source:"@site/docs/Guide/http.md",sourceDirName:"Guide",slug:"/Guide/http",permalink:"/Guide/http",draft:!1,unlisted:!1,tags:[{label:"request",permalink:"/tags/request"},{label:"response",permalink:"/tags/response"},{label:"error",permalink:"/tags/error"},{label:"context",permalink:"/tags/context"}],version:"current",sidebarPosition:4,frontMatter:{title:"Http Helpers",sidebar_position:4,tags:["request","response","error","context"]},sidebar:"defaultSidebar",previous:{title:"Routing",permalink:"/Guide/routing"},next:{title:"Errors",permalink:"/Guide/error"}},d={},o=[{value:"Request",id:"request",level:2},{value:"Response",id:"response",level:2},{value:"Return value as response",id:"return-value-as-response",level:3},{value:"Async",id:"async",level:3},{value:"Streams",id:"streams",level:3},{value:"Generators",id:"generators",level:3},{value:"Hooks",id:"hooks",level:3},{value:"References",id:"references",level:2},{value:"getRequest",id:"getrequest",level:3},{value:"getResponse",id:"getresponse",level:3},{value:"getBody",id:"getbody",level:3},{value:"setStatusCode",id:"setstatuscode",level:3},{value:"getHeaders",id:"getheaders",level:3},{value:"getHeader",id:"getheader",level:3},{value:"getQueries",id:"getqueries",level:3},{value:"getQuery",id:"getquery",level:3},{value:"setHeader",id:"setheader",level:3},{value:"redirect",id:"redirect",level:3},{value:"abort",id:"abort",level:3},{value:"assertError",id:"asserterror",level:3}];function c(e){const s={code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.p,{children:"The request/response are globally accessible anywhere from request contexts."}),"\n",(0,r.jsx)(s.h2,{id:"request",children:"Request"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:'import { getBody, getRequest } from "@minimajs/server";\napp.get("/", () => {\n  // highlight-next-line\n  const request = getRequest();\n  return request.url;\n});\napp.post("/", () => createUser(getBody()));\n'})}),"\n",(0,r.jsx)(s.p,{children:"And even you can use request in nested function calls"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:'function getURL() {\n  // highlight-next-line\n  return getRequest().url;\n}\napp.get("/", () => {\n  const url = getURL();\n  return url;\n});\n'})}),"\n",(0,r.jsx)(s.h2,{id:"response",children:"Response"}),"\n",(0,r.jsx)(s.h3,{id:"return-value-as-response",children:"Return value as response"}),"\n",(0,r.jsx)(s.p,{children:"just return the value will be a response"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:'app.get("/", () => {\n  return "Hello world";\n});\n'})}),"\n",(0,r.jsx)(s.h3,{id:"async",children:"Async"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:'app.get("/", async () => {\n  const response = await fetch("https://.../");\n  return response.json();\n});\n'})}),"\n",(0,r.jsx)(s.h3,{id:"streams",children:"Streams"}),"\n",(0,r.jsx)(s.p,{children:"Any Readable streams are a valid response"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:'import { createReadStream } from "node:fs";\n\napp.get("/", async () => {\n  return createReadStream("package.json");\n});\n'})}),"\n",(0,r.jsx)(s.h3,{id:"generators",children:"Generators"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:'import { setTimeout as sleep } from "node:timers/promise";\n\nasync function* getDates() {\n  yield new Date().toString();\n  await sleep(1000);\n  yield new Date().toString();\n}\n\napp.get("/", getDates);\n'})}),"\n",(0,r.jsx)(s.h3,{id:"hooks",children:"Hooks"}),"\n",(0,r.jsxs)(s.p,{children:["Using ",(0,r.jsx)(s.code,{children:"defer"})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-ts",children:'function saveUser() {\n  // saving user\n  // save some log\n  // highlight-start\n  defer(() => {\n    console.log("deleting log");\n    // delete log\n    // this will executed after request context completed\n  });\n  // highlight-end\n}\n'})}),"\n",(0,r.jsx)(s.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(s.p,{children:["The following functions are exposed from ",(0,r.jsx)(s.code,{children:"@minimajs/server"})," for handling HTTP requests and responses:"]}),"\n",(0,r.jsx)(s.h3,{id:"getrequest",children:"getRequest"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"getRequest(): Request\n"})}),"\n",(0,r.jsx)(s.p,{children:"Retrieves the HTTP request object."}),"\n",(0,r.jsx)(s.h3,{id:"getresponse",children:"getResponse"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"getResponse(): Response\n"})}),"\n",(0,r.jsx)(s.p,{children:"Retrieves the HTTP response object."}),"\n",(0,r.jsx)(s.h3,{id:"getbody",children:"getBody"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"getBody<T = unknown>(): T\n"})}),"\n",(0,r.jsx)(s.p,{children:"Retrieves the request body."}),"\n",(0,r.jsx)(s.h3,{id:"setstatuscode",children:"setStatusCode"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"setStatusCode(statusCode: keyof typeof StatusCodes | number): Response\n"})}),"\n",(0,r.jsx)(s.p,{children:"Sets the HTTP status code for the response."}),"\n",(0,r.jsx)(s.h3,{id:"getheaders",children:"getHeaders"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"getHeaders(): Record<string, string | string[]>\n"})}),"\n",(0,r.jsx)(s.p,{children:"Retrieves the request headers."}),"\n",(0,r.jsx)(s.h3,{id:"getheader",children:"getHeader"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"getHeader<T = string | undefined>(name: string): T\n"})}),"\n",(0,r.jsx)(s.p,{children:"Retrieves the value of a specific request header."}),"\n",(0,r.jsx)(s.h3,{id:"getqueries",children:"getQueries"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"getQueries<T = ParsedUrlQuery>(): T\n"})}),"\n",(0,r.jsx)(s.p,{children:"Retrieves the URL query parameters."}),"\n",(0,r.jsx)(s.h3,{id:"getquery",children:"getQuery"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"getQuery<T>(name: string): T\n"})}),"\n",(0,r.jsx)(s.p,{children:"Retrieves the value of a specific URL query parameter."}),"\n",(0,r.jsx)(s.h3,{id:"setheader",children:"setHeader"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"setHeader(name: string, value: string): Response\n"})}),"\n",(0,r.jsx)(s.p,{children:"Sets a response header."}),"\n",(0,r.jsx)(s.h3,{id:"redirect",children:"redirect"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"redirect(path: string, isPermanent?: boolean): never\n"})}),"\n",(0,r.jsx)(s.p,{children:"Throws a RedirectError to redirect the client to a specified path."}),"\n",(0,r.jsx)(s.h3,{id:"abort",children:"abort"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"abort(message: string, statusCode: keyof typeof StatusCodes | number): never\n"})}),"\n",(0,r.jsx)(s.p,{children:"Throws an HttpError to abort the current operation with a specified message and status code."}),"\n",(0,r.jsx)(s.h3,{id:"asserterror",children:"assertError"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",children:"assertError(err: unknown): void\n"})}),"\n",(0,r.jsx)(s.p,{children:"Asserts that the provided value is an instance of Error."}),"\n",(0,r.jsxs)(s.p,{children:["These functions provide essential utilities for handling HTTP requests and responses within request context built-in ",(0,r.jsx)(s.code,{children:"@minimajs/server"}),"."]})]})}function u(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},6491:(e,s,n)=>{n.d(s,{R:()=>a,x:()=>l});var r=n(1654);const t={},i=r.createContext(t);function a(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);