"use strict";(self.webpackChunk_minimajs_docs=self.webpackChunk_minimajs_docs||[]).push([[9146],{9821:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>c,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var t=a(86),s=a(6491);const r={title:"Routing",sidebar_position:3,tags:["app"]},i=void 0,l={id:"Guide/routing",title:"Routing",description:"The Basic",source:"@site/docs/Guide/routing.md",sourceDirName:"Guide",slug:"/Guide/routing",permalink:"/Guide/routing",draft:!1,unlisted:!1,tags:[{label:"app",permalink:"/tags/app"}],version:"current",sidebarPosition:3,frontMatter:{title:"Routing",sidebar_position:3,tags:["app"]},sidebar:"defaultSidebar",previous:{title:"Getting started",permalink:"/Guide/getting-started"},next:{title:"Http Helpers",permalink:"/Guide/http"}},o={},p=[{value:"The Basic",id:"the-basic",level:3},{value:"Available methods",id:"available-methods",level:3},{value:"Route Parameters",id:"route-parameters",level:3},{value:"Optionals parameters",id:"optionals-parameters",level:3},{value:"Wildcard",id:"wildcard",level:3},{value:"RegExp",id:"regexp",level:3}];function d(e){const n={a:"a",code:"code",em:"em",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h3,{id:"the-basic",children:"The Basic"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'app.get("/", () => "Welcome Home!");\n'})}),"\n",(0,t.jsx)(n.p,{children:"That's it."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl http://localhost:1234\n> Welcome Home!\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"app.route(options);\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Routes options:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"method"}),": currently it supports 'DELETE', 'GET', 'HEAD', 'PATCH', 'POST', 'PUT', 'OPTIONS', 'SEARCH', 'TRACE', 'PROPFIND', 'PROPPATCH', 'MKCOL', 'COPY', 'MOVE', 'LOCK' and 'UNLOCK'. It could also be an array of methods."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"url"}),": the path of the URL to match this route (alias: path)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"handler(request, reply)"}),": the function that will handle this request."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"bodyLimit"}),": prevents the default JSON body parser from parsing request bodies larger than this number of bytes. Must be an integer. You may also set this option globally when first creating the ",(0,t.jsx)(n.code,{children:"app"})," instance with ",(0,t.jsx)(n.code,{children:"createApp(options)"}),". Defaults to 1048576 (1 MiB)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"logLevel"}),": set log level for this route. See below."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'app.route({\n  method: "GET",\n  url: "/",\n  handler() {\n    return "Hello World";\n  },\n});\n'})}),"\n",(0,t.jsx)(n.h3,{id:"available-methods",children:"Available methods"}),"\n",(0,t.jsx)(n.p,{children:"The router allows you to register routes that respond to any HTTP verb:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:"app.get(path, [options], handler);\napp.post(path, [options], handler);\napp.put(path, [options], handler);\napp.patch(path, [options], handler);\napp.delete(path, [options], handler);\napp.head(path, [options], handler);\napp.options(path, [options], handler);\napp.all(path, [options], handler); // will add the same handler to all the supported methods.\n"})}),"\n",(0,t.jsx)(n.h3,{id:"route-parameters",children:"Route Parameters"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'app.get("/users/:user", () => {\n  const params = getParams<{ user: string }>();\n  return { user: params.user };\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:"You may define as many route parameters as required by your route:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'app.get("/posts/:post/comments/:comment", () => {\n  // highlight-next-line\n  const params = getParams<{ post: string; comment: string }>();\n  return [params.post, params.comment];\n});\n'})}),"\n",(0,t.jsx)(n.h3,{id:"optionals-parameters",children:"Optionals parameters"}),"\n",(0,t.jsx)(n.p,{children:'The last parameter can be made optional if you add a question mark ("?") to the end of the parameters name.'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'// highlight-next-line\napp.get("/posts/:post?", () => {\n  const params = getParams<{ post?: string }>();\n  return [params.post ?? "not defined"];\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:"In this case you can request /example/posts as well as /example/posts/1. The optional param will be undefined if not specified."}),"\n",(0,t.jsx)(n.h3,{id:"wildcard",children:"Wildcard"}),"\n",(0,t.jsx)(n.p,{children:"For wildcard, use the star. Remember that static routes are always checked before parametric and wildcard."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'// highlight-next-line\napp.get("/posts/*", () => {\n  const params = getParams<{ post?: string }>();\n  return [params.post ?? "not defined"];\n});\n'})}),"\n",(0,t.jsx)(n.h3,{id:"regexp",children:"RegExp"}),"\n",(0,t.jsx)(n.p,{children:"Regular expression routes are supported as well, but be aware that you have to escape slashes. Take note that RegExp is also very expensive in terms of performance!"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'// parametric with regexp\napp.get("/example/:file(^\\\\d+).png", function () {\n  // curl ${app-url}/example/12345.png\n  // file === \'12345\'\n  const file = getParam("file");\n  // your code here\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:'It is possible to define more than one parameter within the same couple of slash ("/"). Such as:'}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { getParams } from "@minimajs/server";\napp.get("/example/near/:lat-:lng/radius/:r", function () {\n  // curl ${app-url}/example/near/15\xb0N-30\xb0E/radius/20\n  // lat === "15\xb0N"\n  // lng === "30\xb0E"\n  // r ==="20"\n  const { lat, lng, r } = getParams<{ lat: string; lng: string; r: string }>();\n  // your code here\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.em,{children:'Remember in this case to use the dash ("-") as parameters separator.'})}),"\n",(0,t.jsx)(n.p,{children:"Finally, it is possible to have multiple parameters with RegExp:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'app.get("/example/at/:hour(^\\\\d{2})h:minute(^\\\\d{2})m", () => {\n  // curl ${app-url}/example/at/08h24m\n  // hour === "08"\n  // minute === "24"\n  const { hour, minute } = getParams<{ hour: string; minute: string }>();\n  // your code here\n});\n'})}),"\n",(0,t.jsx)(n.p,{children:"In this case as parameter separator it is possible to use whatever character is not matched by the regular expression."}),"\n",(0,t.jsx)(n.p,{children:"If you want a path containing a colon without declaring a parameter, use a double colon. For example:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'app.post("/name::verb"); // will be interpreted as /name:verb\n'})}),"\n",(0,t.jsx)(n.p,{children:"Having a route with multiple parameters may negatively affect performance, so prefer a single parameter approach whenever possible, especially on routes that are on the hot path of your application."}),"\n",(0,t.jsxs)(n.p,{children:["If you are interested in how we handle the routing, check out ",(0,t.jsx)(n.a,{href:"https://github.com/delvedor/find-my-way",children:"find-my-way"})]})]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},6491:(e,n,a)=>{a.d(n,{R:()=>i,x:()=>l});var t=a(1654);const s={},r=t.createContext(s);function i(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);